      PROGRAM MAYNARD(INPUT,OUTPUT,TAPE5=INPUT,TAPE6=OUTPUT)
      DIMENSION IPOP(1000),F(500),G(500),P(10)
      INTEGER TI,TR
      MULT=5**19
      AFRAC=2.**(-48)
      READ(5,101) INT
  101 FORMAT(O20)
      WRITE(6,102) INT
  102 FORMAT(1H1,21HINITIAL RANDOM NO. = ,O20)
    1 READ(5,2) U,S,NPOP,TI,TR,NREPS
    2 FORMAT(2F10.8,4I5)
      IF(U.LE.0.) GO TO 1000
      WRITE(6,103) U,S,NPOP,TI,TR,NREPS
  103 FORMAT(1H0,16HMUTATION RATE = ,G12.4,2X,22HSELECTIVE ADVANTAGE = ,
     1 G12.4/1X,18HPOPULATION SIZE = ,I5/1X,I5,21H INITIAL GENERATIONS,,
     2 I5,21H RECORDED GENERATIONS/1X,10HREPLICATED,I5,6H TIMES)
      Z=FLOAT(NPOP)*U*(1.-EXP(-2.*S))/(1.-EXP(-2.*FLOAT(NPOP)*S))
      WRITE(6,3) Z
    3 FORMAT(1H0,11HEXPECTED = ,G15.7)
      P(1)=EXP(-U)
      DO 4 I=2,10
    4 P(I)=P(I-1)*U/FLOAT(I-1)
      SUMN=0.
      SUMG=0.
      SUMG2=0.
      DO 300 IR=1,NREPS
      NMIN=1
      NMAX=1
      DO 10 I=1,NPOP
   10 IPOP(I)=0
      ITIME=TI&TR
      NNN=0
      DO 200 IT=1,ITIME
      DO 20 I=NMIN,NMAX
   20 F(I)=0.
      L=1
      M=IPOP(1)&1-NNN
      DO 30 I=1,NPOP
      K=IPOP(I)-NNN
      L=MAX0(L,K&1)
      M=MIN0(M,K&1)
   30 F(K&1)=F(K&1)&1.
      NMAX=L
      NMIN=M
      NNN1=NNN&NMIN-1
      IF(IT.NE.TI&1) GO TO 50
      SX=0.
      DO 40 I=NMIN,NMAX
   40 SX=SX&F(I)*FLOAT(I-1)
      XLOW=SX/FLOAT(NPOP)&FLOAT(NNN)
   50 NM=NMAX&9
      DO 60 I=NMIN,NM
   60 G(I)=0.
      DO 62 I=NMIN,NMAX
      DO 62 J=1,10
      K=I&J-1
   62 G(K)=G(K)&F(I)*P(J)
      NMAX=NMAX&9
      DO 63 I=NMIN,NMAX
   63 F(I)=G(I)
      A=1.
      DO 70 I=NMIN,NMAX
      F(I)=F(I)*A
   70 A=A*(1.&S)
      NM=NMIN&1
      DO 80 I=NM,NMAX
   80 F(I)=F(I)&F(I-1)
      SUM=F(NMAX)
      DO 90 I=1,NPOP
      INT=INT*MULT
      Y=AFRAC*FLOAT(INT)*SUM
      DO 100 IA=NMIN,NMAX
      IF(Y.LE.F(IA)) GO TO 110
  100 CONTINUE
  110 IPOP(I)=IA&NNN-1
   90 CONTINUE
      NNN=NNN1
  200 CONTINUE
      SX=0.
      DO 250 I=1,NPOP
  250 SX=SX&FLOAT(IPOP(I))
      XUP=SX/FLOAT(NPOP)
      GAIN=(XUP-XLOW)/FLOAT(TR)
      WRITE(6,260) GAIN
  260 FORMAT(1X,F10.5)
      SUMN=SUMN&1.
      SUMG=SUMG&GAIN
      SUMG2=SUMG2&GAIN**2
  300 CONTINUE
      GMEAN=SUMG/SUMN
      GVAR=(SUMG2/SUMN-GMEAN**2)/SUMN
      GSD=0.
      IF(GVAR.GT.0.) GSD=SQRT(GVAR)
      WRITE(6,301) GMEAN,GSD
  301 FORMAT(1X,7HMEAN = ,G15.7,2X,7HS.E. = ,G15.7)
      IF(GMEAN.LE.0.) GO TO 1
      RATIO=Z/GMEAN
      SER=RATIO*GSD/GMEAN
      WRITE(6,302) RATIO,SER
  302 FORMAT(1X,39HRECOMBINATION ACCELERATES BY FACTOR OF ,G15.7/1X,
     1 17HSTANDARD ERROR = ,G15.7)
      GO TO 1
 1000 WRITE(6,1001) INT
 1001 FORMAT(1X,22HFINAL RANDOM NUMBER = ,O20)
      STOP
      END
 
